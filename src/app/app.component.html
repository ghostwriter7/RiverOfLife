<div class="wrapper">
  <table>
    <thead>
    <tr>
      <th>Mon</th>
      <th>Tue</th>
      <th>Wed</th>
      <th>Thu</th>
      <th>Fri</th>
      <th>Sat</th>
      <th>Sun</th>
    </tr>
    </thead>
    <tbody>
      @for (week of weeks; track $index) {
        <tr>
          @for (day of week; track $index) {
            <td
              [class.success]="day.state === 'success'"
              [class.failure]="day.state === 'failure'"
              [class.odd]="day.isOdd"
              (touchstart)="onTouchStart(day)"
              (touchend)="onTouchEnd($event, day)"
              (contextmenu)="showDetails($event, day)"
              (click)="onCellClick(day)">
              <div class="cell">
                <span>{{ day.date | date: 'd' }}</span>

                @if (day.monthLabel) {
                  <span class="month-label">{{ day.monthLabel }}</span>
                }
              </div>
            </td>
          }
        </tr>
      }
    </tbody>
  </table>
</div>

<dialog #details (close)="onDetailsClose()">
  <div class="details"><h3>{{ currentCell()?.date | date: 'shortDate' }}</h3>
    <form [formGroup]="form">
      <label for="climbing">
        Climbing Training
        <input formControlName="climbing" type="checkbox" id="climbing">
      </label>

      <label for="sugar-free">
        Sugar-Free Diet
        <input formControlName="sugarFree" type="checkbox" id="sugar-free">
      </label>

      <label for="mental-hygiene">
        Mental Hygiene
        <input formControlName="mentalHealth" type="checkbox" id="mental-hygiene">
      </label>
    </form>

    <button (click)="details.close()">Done</button>
  </div>
</dialog>
